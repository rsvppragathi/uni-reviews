"use strict";var Question=Backbone.Model.extend({}),QuestionCollection=Backbone.Collection.extend({idAttribute:"_id",model:Question,initialize:function(e){this.search=e.search?e.search:null},url:function(){return this.search?"/api/search/"+encodeURI(this.search):"/api/questions/"}}),SchoolView=Backbone.View.extend({container:"#app",template:_.template($("#school_template").html()),events:{"click #ask-btn":"handleSearch"},initialize:function(){this.schoolData={name:"Cal Poly San Luis Obispo",image:"calpolybackground.jpg"},this.render()},handleSearch:function(e){var t=this.$("#ask").val();new SearchView({search:t})},render:function(){this.$el.html(this.template(this.schoolData)),$(this.container).html(this.$el),this.$el.find("#ask").focus()}}),SearchView=Backbone.View.extend({container:"#app",template:_.template($("#search_results_template").html()),initialize:function(e){this.search=e.search?e.search:null,this.fetchQuestions()},fetchQuestions:function(){this.collection=new QuestionCollection({search:this.search}),this.listenTo(this.collection,"sync",this.render),this.collection.fetch()},render:function(){this.$el.html(this.template({questions:this.collection.toJSON(),search:this.search})),$(this.container).html(this.$el)}}),Router=Backbone.Router.extend({routes:{"":"school","search/:query":"search"},initialize:function(){},school:function(){new SchoolView}});$(document).ready(function(){new Router;Backbone.history.start({pushState:!0})});